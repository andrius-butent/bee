<?xml version="1.0" encoding="UTF-8"?>
<g:Grid xmlns="http://www.butent.com/column" xmlns:g="http://www.butent.com/grid"
        xmlns:ui="http://www.butent.com/ui"

        name="CargoIncomes" viewName="CargoIncomes"
        flexGrow="1"
        newRowCaption="=trNewService"
    >
  <g:columns>
    <DataColumn name="Date" caption="=date">
      <validation>
        <ui:function>
          if (cell.newValue &lt;= new Date()) {
          return null;
          }
          return $wnd.Bee_maybeTranslate("=invalidDate");
        </ui:function>
      </validation>
    </DataColumn>
    <RelColumn name="Service" caption="=trServiceName" renderColumns="ServiceName" />
    <DataColumn name="Amount" format="0.00" />
    <RelColumn name="Currency" caption="=currencyShort" flexGrow="0" />
    <DataColumn name="VatPlus" width="20" sortable="false" horizontalAlignment="center" caption="+">
      <render>
        <ui:expression>row.VatPlus ? '+' : ''</ui:expression>
      </render>
    </DataColumn>
    <DataColumn name="Vat">
      <editor type="number" percentageTag="VatPercent" />
        </DataColumn>
    <DataColumn name="VatPercent" width="20" sortable="false" horizontalAlignment="center" caption="%">
      <render><ui:expression>row.VatPercent ? '%' : ''</ui:expression></render>
    </DataColumn>
    <CalcColumn name="Total" type="decimal" caption="=totalOf" format="0.00">
      <style>
        <bodyStyle>
          <ui:font>bold</ui:font>
        </bodyStyle>
      </style>
      <renderer type="total" />
    </CalcColumn>

    <DataColumn name="AdditionalRoute" />
    <DataColumn name="ShowAdditionalRoute" width="50" />
    <DataColumn name="InsuranceCertificate" >
      <renderer type="list" />
      <editor type="list"  >
        <ui:item>=yes</ui:item>
        <ui:item>=no</ui:item>
      </editor>
      <validation>
        <ui:function>
          if (row.ServicePercent != null) {
            if(cell.newValue != null) {
             return null;
            } else {
              return $wnd.Bee_maybeTranslate("=valueRequired");
            }
          } else if (row.ServicePercent == null) {
            if(cell.newValue == null) {
               return null;
            } else {
             return $wnd.Bee_maybeTranslate("=rowIsReadOnly");
            }
          }
        </ui:function>
      </validation>
    </DataColumn>

    <RelColumn name="Customer" />
    <DataColumn name="Number" />
    <DataColumn name="Note" />

    <RelColumn name="Sale" caption="=trInvoiceIdShort" readOnly="true" cellType="html"
               editEnabled="true" editForm="CargoInvoice" editViewName="CargoInvoices">
      <render>
        <ui:expression>row.SaleDate ? (row.SaleDate.toISOString().substring(0, 10)
          + " &lt;strong&gt;" + (row.SalePrefix ? row.SalePrefix : " ") + row.SaleNo + "&lt;/strong&gt;")
          : ""
        </ui:expression>
      </render>
    </RelColumn>
    <RelColumn name="Purchase" caption="=trCreditIdShort" readOnly="true"
               renderColumns="Purchase PurchasePrefix PurchaseNo" editEnabled="true"
               editForm="CargoPurchaseInvoice" editViewName="CargoPurchaseInvoices" />
  </g:columns>

  <g:rowEditable>
    <ui:expression>!row.Sale &amp;&amp; !row.Purchase</ui:expression>
  </g:rowEditable>
</g:Grid>
