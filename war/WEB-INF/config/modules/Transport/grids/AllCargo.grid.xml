<?xml version="1.0" encoding="UTF-8"?>
<Grid xmlns="http://www.butent.com/grid"
  xmlns:ui="http://www.butent.com/ui"

  name="AllCargo" viewName="AllCargo" caption="=cargos" disabledActions="delete"
  flexGrow="1" newRowPopup="true" order="OrderID desc"
  >
  <body height="50" />

  <columns>
    <DataColumn name="OrderNo" caption="=orderNumber" />
    <DataColumn name="Status" caption="=status" itemKey="OrderStatus" />    
    <RelColumn name="Customer" caption="=customer" />
    <RelColumn name="Manager" caption="=manager" />

    <RelColumn name="Cargo" viewName="OrderCargo" renderColumns="Description" caption="=cargo"
      maxWidth="200" editEnabled="true" filterSupplier="value" />

    <CalcColumn name="Loading" type="string" cellType="html" caption="=loading" 
      searchBy="LoadingCountryName" />
    <CalcColumn name="Unloading" type="string" cellType="html" caption="=unloading"
      searchBy="UnloadingCountryName" />

    <DataColumn name="Partial" caption="D" width="15" sortable="false" />
    <DataColumn name="Outsized" caption="N" width="15" sortable="false" />
    <DataColumn name="Dangerous" caption="P" width="15" sortable="false" />
    <DataColumn name="Number" caption="=cargoNumber" />
    <DataColumn name="Cmr" caption="CMR" />
    <DataColumn name="CargoNotes" caption="=cargoNotes" maxWidth="200">
      <style>
        <bodyStyle>
          <ui:inline>white-space: pre-wrap;</ui:inline>
        </bodyStyle>
      </style>
    </DataColumn>

    <ActionColumn name="TripNo" element="link" />
    <DataColumn name="ExpeditionType" caption="=trExpeditionType" />
    <DataColumn name="ForwarderName" caption="=carrier" />
    <CalcColumn name="Vehicle" type="string" caption="=transport" 
      searchBy="ForwarderVehicle VehicleNumber TrailerNumber">
      <render>
        <ui:function>
          var vehicle = row.ForwarderVehicle;

          if (!vehicle) {
            vehicle = row.VehicleNumber;

            if (row.TrailerNumber) {
              vehicle = vehicle + ' / ' + row.TrailerNumber;
            }
          }
          return vehicle;
        </ui:function>
      </render>
    </CalcColumn>
    <CalcColumn name="Driver" type="string" caption="=vehicleDriver"
      searchBy="ForwarderDriver DriverLastName DriverFirstName">
      <render>
        <ui:function>
          var driver = row.ForwarderDriver;

          if (!driver) {
            driver = row.DriverFirstName;

            if (row.DriverLastName) {
              driver = driver + ' ' + row.DriverLastName;
            }
          }
          return driver;
        </ui:function>
      </render>
    </CalcColumn>
  </columns>
</Grid>
