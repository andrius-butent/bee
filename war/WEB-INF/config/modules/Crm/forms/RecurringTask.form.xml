<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE Form [
  <!ENTITY tbl "border-collapse: collapse;">
  <!ENTITY cell "vertical-align: top; padding-bottom: 2px;">
  <!ENTITY col1 "text-align: right; padding-right: 8px;">
  <!ENTITY col3 "text-align: right; padding-left: 8px; padding-right: 8px;">

  <!ENTITY inp2x "width: 500px;">
  <!ENTITY inp2y "width: 400px;">
  
  <!ENTITY timeStep "30">
]>
<f:Form xmlns="http://www.butent.com/widget"
  xmlns:f="http://www.butent.com/form"
  xmlns:xi="http://www.w3.org/2001/XInclude"
  
  name="RecurringTask" viewName="RecurringTasks" caption="=crmRecurringTask"
  width="700" height="600">

  <FlowPanel class="flexBox-vertical" style="padding: 10px 2px 2px 10px;">
  
    <Table style="&tbl;" cellStyle="padding-bottom: 5px;">
      <col index="0" cellStyle="&col1;" />
      <col index="2" cellStyle="&col3;" />

      <row>
        <Label text="=crmRTScheduleAfter" class="bee-required" />
        <InputDateTime source="ScheduleAfter" />
        <Label text="=crmRTScheduleBefore" />
        <InputDateTime source="ScheduleBefore" />
      </row>

      <row>
        <Label text="=crmTaskManager" class="bee-required" />
        <DataSelector source="Owner" editPopup="true" newRowEnabled="false"
          renderColumns="OwnerFirstName OwnerLastName"
          choiceColumns="FirstName LastName CompanyName" />
        <Label text="=priority" />
        <Radio source="Priority" />
      </row>

      <row>
        <Label text="=company" />
        <DataSelector source="Company" editPopup="true" newRowEnabled="false" />
        <Label text="=personContact" />
        <DataSelector source="Contact" editPopup="true" newRowEnabled="false"
          renderColumns="ContactFirstName ContactLastName"
          choiceColumns="FirstName LastName CompanyName" options="Company" />
      </row>
    </Table>
    
    <br/>
    <Table style="&tbl;" cellStyle="&cell;">
      <col index="0" cellStyle="&col1;" />
      
      <row>
        <Label text="=taskTheme" class="bee-required" />
        <InputText source="Summary" style="&inp2x;" autocomplete="true" />
      </row>

      <row>
        <Label text="=description" />
        <InputArea source="Description" style="&inp2x; height: 60px;" />
      </row>
    </Table>

    <br/>
    <Table style="&tbl;" cellStyle="&cell;">
      <col index="0" cellStyle="&col1;" />

      <row>
        <Label text="=crmTaskExecutors" />
        <ChildSelector childTable="RTExecutors" viewName="Users" renderColumns="FirstName LastName"
          editPopup="true" newRowEnabled="false" style="&inp2x;" label="=crmTaskExecutors" />
      </row>

      <row>
        <Label text="=crmTaskExecutorGroups" />
        <ChildSelector childTable="RTExecutorGroups" viewName="UserGroupSettings"
          renderColumns="Name" editPopup="true" newRowEnabled="false" style="&inp2y;"
          label="=crmTaskExecutorGroups" filter="Owner {u} or Visibility 1" />
      </row>

      <row>
        <Label text="=crmTaskObservers" />
        <ChildSelector childTable="RTObservers" viewName="Users" renderColumns="FirstName LastName"
          editPopup="true" newRowEnabled="false" style="&inp2x;" label="=crmTaskObservers" />
      </row>

      <row>
        <Label text="=crmTaskObserverGroups" />
        <ChildSelector childTable="RTObserverGroups" viewName="UserGroupSettings"
          renderColumns="Name" editPopup="true" newRowEnabled="false"
          style="&inp2y;" label="=crmTaskObserverGroups" filter="Owner {u} or Visibility 1" />
      </row>
    </Table>

    <br/>
    <TabbedPages class="flexible">
      <page>
        <text>=crmRecurrence</text>
        <FlowPanel>
          <br/>
          <Table style="&tbl;" cellStyle="&cell;">
            <col index="0" cellStyle="&col1;" />
      
            <row>
              <Label text="=crmRTDayOfMonth" />
              <InputText source="DayOfMonth" />
            </row>
            <row>
              <Label text="=crmRTMonth" />
              <InputText source="Month" />
            </row>
            <row>
              <Label text="=crmRTDayOfWeek" />
              <InputText source="DayOfWeek" />
            </row>
            <row>
              <Label text="=crmRTYear" />
              <InputText source="Year" />
            </row>
          </Table>
          
          <br/>
          <HorizontalPanel style="&tbl;" cellStyle="padding-right: 1em;">
            <Label text="=crmRTStartAt" />
            <InputTimeOfDay source="StartAt" step="&timeStep;" style="width: 50px;" />
            <Label text="=duration" />
            <InputSpinner source="DurationDays" minValue="0" maxValue="31" style="width: 40px;" />
            <InputSpinner source="DurationHours" minValue="0" maxValue="23" style="width: 40px;" />
            <InputSpinner source="DurationMinutes" minValue="0" maxValue="59" style="width: 40px;" />
          </HorizontalPanel>

          <br/>
          <HorizontalPanel style="&tbl;" cellStyle="padding-right: 1em;">
            <Label text="=taskReminder" />
            <DataSelector source="Reminder" renderColumns="ReminderName" newRowEnabled="false" />
            <Label text="=crmRTRemindBefore" />
            <InputSpinner source="RemindBefore" minValue="0" maxValue="31" style="width: 40px;" />
            <Label text="=crmRTRemindAt" />
            <InputTimeOfDay source="RemindAt" step="&timeStep;" style="width: 50px;" />
          </HorizontalPanel>
        </FlowPanel>
      </page>

      <page>
        <text>=relatedTo</text>
        <Table style="&tbl; margin-top: 2ex;" cellStyle="&cell;">
          <col index="0" cellStyle="&col1;" />
      
          <row>
            <Label text="=companies" />
            <ChildSelector childTable="Relations" viewName="Companies" renderColumns="Name"
              editPopup="true" newRowEnabled="false" style="&inp2x;" />
          </row>
    
          <row>
            <Label text="=persons" />
            <ChildSelector childTable="Relations" viewName="Persons" 
              renderColumns="FirstName LastName" editPopup="true" newRowEnabled="false" 
              style="&inp2x;" />
          </row>
    
          <row>
            <Label text="=appointments" />
            <ChildSelector childTable="Relations" viewName="Appointments"
              renderColumns="Summary" choiceColumns="Summary StartDateTime EndDateTime"
              newRowEnabled="false" editPopup="true" style="&inp2x;" />
          </row>
    
          <row>
            <Label text="=discussions" />
            <ChildSelector childTable="Relations" viewName="Discussions"
              renderColumns="Subject" newRowEnabled="false" editPopup="true" style="&inp2x;" />
          </row>
    
          <row>
            <Label text="=tasks" />
            <ChildSelector childTable="Relations" viewName="Tasks" 
              renderColumns="Summary ExecutorFirstName ExecutorLastName"
              choiceColumns="Summary ExecutorFirstName ExecutorLastName StartTime FinishTime"
              newRowEnabled="false" editPopup="true" style="&inp2x;" />
            </row>
        </Table>
      </page>
    </TabbedPages>
  </FlowPanel>
</f:Form>
