<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE Form [
  <!ENTITY MARGIN_LEFT "margin-left: 1em;">
  <!ENTITY MARGIN_TOP "margin-top: 1ex;">

  <!ENTITY ROW_STYLE "margin-bottom: 1ex;">
  <!ENTITY LABEL_STYLE "&MARGIN_LEFT; margin-right: 1em;">
  <!ENTITY LEFT_LABEL_STYLE "&LABEL_STYLE; display: inline-block; min-width: 100px;">
  <!ENTITY DISPLAY_STYLE "display: inline-block; padding: 2px; border: 1px solid #aaa; margin-left: 2px;">
  <!ENTITY BUTTON_STYLE "background-color: #109610; color: white; font-family: Georgia;">
]>

<Form xmlns="http://www.butent.com/bee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.butent.com/bee ../../../../schemas/form.xsd"
  xmlns:xi="http://www.w3.org/2001/XInclude"
  
  name="Project" viewName="Projects" caption="Projektas">

  <FlowPanel class="flexBox-vertical">
    <FlowPanel class="flexBox-horizontal" style="&MARGIN_TOP;">
      <FlowPanel class="flexible" style="min-width: 600px;">
        <FlowPanel style="&ROW_STYLE; ">
          <InlineLabel html="Pavadinimas:" style="&LEFT_LABEL_STYLE;" />
          <InputText source="Name" style="width: 400px;" />
        </FlowPanel>

        <FlowPanel style="&ROW_STYLE;">
          <InlineLabel html="Būsena:" style="&LEFT_LABEL_STYLE;" />
          <TextLabel source="Event" itemKey="ProjectEvent" style="&DISPLAY_STYLE;" />
          <InlineLabel html="Pradžia:" style="&LABEL_STYLE;" />
          <DateLabel source="StartDate" inline="true" style="&DISPLAY_STYLE;" />
          <InlineLabel html="Terminas:" style="&LABEL_STYLE;" />
          <DateLabel source="FinishDate" inline="true" style="&DISPLAY_STYLE;" />
        </FlowPanel>

        <HorizontalPanel style="&ROW_STYLE;">
          <cell>
            <Label html="Įmonė:" style="&LEFT_LABEL_STYLE;" />
          </cell>
          <cell>
            <DataSelector source="CompanyName" relSource="Company" relView="Companies"
              relColumn="Name" style="width: 300px;" />
          </cell>
        </HorizontalPanel>
      </FlowPanel>

      <FlowPanel class="flexible" style="margin-right: 1em;">
        <Button name="COMMENTED" html="Naujas komentaras" style="&BUTTON_STYLE;" disablable="false" />
        <Button name="EXTENDED" html="Keisti terminą" style="&BUTTON_STYLE;" />
        <Button name="ACTIVATED" html="Perduoti vykdymui" style="&BUTTON_STYLE;" />
        <Button name="SUSPENDED" html="Sustabdyti" style="&BUTTON_STYLE;" />
        <Button name="CANCELED" html="Nutraukti" style="&BUTTON_STYLE;" />
        <Button name="COMPLETED" html="Užbaigti" style="&BUTTON_STYLE;" />
        <Button name="RENEWED" html="Grąžinti vykdymui" style="&BUTTON_STYLE;" />
      </FlowPanel>
    </FlowPanel>

    <TabbedPages barHeight="24" class="flexible" style="&MARGIN_TOP;">
      <page>
        <text>Papildoma informacija</text>
        <FlowPanel style="&MARGIN_TOP;">
          <FlowPanel style="&ROW_STYLE; ">
            <InlineLabel html="Prioritetas:" style="&LEFT_LABEL_STYLE;" />
            <xi:include href="widgets/Priority.widget.xml" />
            <InlineLabel html="Numatoma trukmė min.:" style="&LABEL_STYLE;" />
            <InputLong source="ExpectedDuration" style="width: 60px;" />
          </FlowPanel>

          <HorizontalPanel style="&ROW_STYLE;">
            <cell>
              <Label html="Tipas:" style="&LEFT_LABEL_STYLE;" />
            </cell>
            <cell>
              <DataSelector source="TypeName" relSource="ProjectType" relView="ProjectTypes"
                relColumn="Name" />
            </cell>
          </HorizontalPanel>
          <HorizontalPanel style="&ROW_STYLE;">
            <cell>
              <Label html="Asmuo:" style="&LEFT_LABEL_STYLE;" />
            </cell>
            <cell>
              <DataSelector source="PersonFirstName" relSource="CompanyPerson" relView="CompanyPersons"
                relColumn="FirstName" />
            </cell>
          </HorizontalPanel>

          <HorizontalPanel style="&ROW_STYLE; ">
            <cell>
              <Label html="Aprašymas:" style="&LEFT_LABEL_STYLE;" />
            </cell>
            <cell>
              <InputArea source="Description" style="min-width: 500px; min-height: 100px;" />
            </cell>
          </HorizontalPanel>
        </FlowPanel>
      </page>

      <page>
        <text>Stebėtojai</text>
        <FlowPanel style="&MARGIN_TOP;">
          <FlowPanel style="&ROW_STYLE; ">
            <InlineLabel html="Autorius:" style="&LEFT_LABEL_STYLE;" />
            <TextLabel style="&DISPLAY_STYLE;">
              <render>
                <function>return (row.OwnerFirstName || "") + " " + (row.OwnerLastName || "")</function>
              </render>
            </TextLabel>
          </FlowPanel>

          <FlowPanel style="&ROW_STYLE; &MARGIN_LEFT;">
            <ListBox name="Observers" multiSelect="true" minSize="2" style="width: 250px" />
            <Button name="AddObservers" html="+" style="width: 2em; &MARGIN_LEFT;" />
            <Button name="RemoveObservers" html="-" style="width: 2em; &MARGIN_LEFT;" />
          </FlowPanel>
        </FlowPanel>
      </page>

      <page>
        <text>Įvykių istorija</text>
        <ChildGrid name="ProjectEvents" relColumn="Project" />
      </page>

      <page>
        <text>Etapai</text>
        <FlowPanel class="flexBox-horizontal" style="&MARGIN_TOP;">
          <ChildTree name="Stages" source="ProjectStages" parentColumn="Parent"
            relationColumn="Project" caption="Projekto etapai">
            <calc>
              <expression>row.Name</expression>
            </calc>
            <form name="Etapo koregavimas">
              <FlexTable>
                <row>
                  <cell>
                    <Label html="Etapas" horizontalAlignment="right" class="bee-required" />
                  </cell>
                  <cell>
                    <InputText source="Name" style="width: 25em" required="true" />
                  </cell>
                </row>
                <row>
                  <cell>
                    <Label html="Aprašymas" horizontalAlignment="right" />
                  </cell>
                  <cell>
                    <InputArea source="Description" visibleLines="4" style="width: 25em" />
                  </cell>
                </row>
              </FlexTable>
            </form>
          </ChildTree>

          <FlowPanel class="flexible flexBox-vertical" style="&MARGIN_LEFT;">
            <FlowPanel style="&ROW_STYLE;">
              <InlineLabel html="Etapo aprašymas:" style="&LABEL_STYLE;" />
              <TextLabel name="StageDescription" style="&DISPLAY_STYLE; white-space: pre-wrap;" />
            </FlowPanel>

            <ChildGrid name="Tasks" relColumn="Project" class="flexible" />
          </FlowPanel>
        </FlowPanel>
      </page>
    </TabbedPages>

  </FlowPanel>
</Form>  
