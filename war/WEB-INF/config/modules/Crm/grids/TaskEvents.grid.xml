<?xml version="1.0" encoding="UTF-8"?>
<Grid xmlns="http://www.butent.com/bee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.butent.com/bee ../../../../schemas/grid.xsd"
  
  name="TaskEvents" viewName="TaskEvents" caption="Įvykių istorija"
  readOnly="true" order="TaskEventID desc" caching="false">

  <body height="48" borderWidth="0">
    <style>
      <font>Tahoma 11 px</font>
    </style>
  </body>

  <columns>
    <CalcColumn name="Publisher" type="string" caption="Paskelbta" width="120">
      <style>
        <bodyStyle>
          <inline>white-space: pre-wrap;</inline>
        </bodyStyle>
      </style>
      <calc>
        <function>
            var s = row.PublishTime.getFullYear() + "." + (row.PublishTime.getMonth() + 1)
                  + (row.PublishTime.getDate() >= 10 ? "." : ".0")
                  + row.PublishTime.getDate() + " " + row.PublishTime.toLocaleTimeString() + "\n"
                  + (row.PublisherFirstName || "") + " " + (row.PublisherLastName || "");
            var ev = $wnd.Bee_getCaption("TaskEvent", row.Event);
            s = s + "\n" + ev;
            return s;
          </function>
      </calc>
    </CalcColumn>
    <CalcColumn name="Comment" type="string" caption="Komentaras" width="240">
      <style>
        <bodyStyle>
          <inline>white-space: pre-wrap;</inline>
        </bodyStyle>
      </style>
      <calc>
        <function>
            var s = "";
            
            if (row.EventNote) {
              s = row.EventNote;
            }
            if (row.Comment) {
              if (s) {
                s = s + "\n";
              }
              s = s + row.Comment;
            }
            return s;
          </function>
      </calc>
    </CalcColumn>
    <CalcColumn name="Duration" type="string" caption="Sugaištas laikas" width="100">
      <style>
        <bodyStyle>
          <inline>white-space: pre-wrap;</inline>
        </bodyStyle>
      </style>
      <calc>
        <function>
            var s = "";
            
            if (row.Duration) {
              s =  row.Duration.getTime() + " min." + "\n" + row.DurationType;
            }
            return s;
          </function>
      </calc>
    </CalcColumn>
  </columns>
</Grid>
