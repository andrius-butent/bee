<?xml version="1.0" encoding="UTF-8"?>
<Grid xmlns="http://www.butent.com/grid"
  xmlns:ui="http://www.butent.com/ui"

  name="TaskEvents" viewName="TaskEvents" caption="Įvykių istorija" headerMode="column"
  readOnly="true" order="TaskEventID desc" cacheData="false">

  <body height="48" borderWidth="0">
    <style>
      <ui:font>Tahoma 11 px</ui:font>
    </style>
  </body>

  <columns>
    <CalcColumn name="Publisher" type="string" caption="Paskelbta" width="120">
      <style>
        <bodyStyle>
          <ui:inline>white-space: pre-wrap;</ui:inline>
        </bodyStyle>
      </style>
      <render>
        <ui:function>
            var s = row.PublishTime.getFullYear() + "." + (row.PublishTime.getMonth() + 1)
                  + (row.PublishTime.getDate() >= 10 ? "." : ".0")
                  + row.PublishTime.getDate() + " " + row.PublishTime.toLocaleTimeString() + "\n"
                  + (row.PublisherFirstName || "") + " " + (row.PublisherLastName || "");
            var ev = $wnd.Bee_getCaption("TaskEvent", row.Event);
            s = s + "\n" + ev;
            return s;
          </ui:function>
      </render>
    </CalcColumn>
    <CalcColumn name="Comment" type="string" caption="Komentaras" width="240">
      <style>
        <bodyStyle>
          <ui:inline>white-space: pre-wrap;</ui:inline>
        </bodyStyle>
      </style>
      <render>
        <ui:function>
            var s = "";
            
            if (row.EventNote) {
              s = row.EventNote;
            }
            if (row.Comment) {
              if (s) {
                s = s + "\n";
              }
              s = s + row.Comment;
            }
            return s;
          </ui:function>
      </render>
    </CalcColumn>
    <CalcColumn name="Duration" type="string" caption="Sugaištas laikas" width="100">
      <style>
        <bodyStyle>
          <ui:inline>white-space: pre-wrap;</ui:inline>
        </bodyStyle>
      </style>
      <render>
        <ui:function>
            var s = "";
            
            if (row.Duration) {
              s =  row.Duration.getTime() + " min." + "\n" + row.DurationType;
            }
            return s;
          </ui:function>
      </render>
    </CalcColumn>
  </columns>
</Grid>
