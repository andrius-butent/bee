<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE Form[
    <!ENTITY inp "width: 250px;">
    <!ENTITY addStyle "display:inline-block; position: inherit;">
]>
<f:Form xmlns="http://www.butent.com/widget"
  xmlns:f="http://www.butent.com/form"

  name="ServiceMaintenance" viewName="ServiceMaintenance" caption="=svcMaintenance" showRowId="true"
>
  <FlowPanel class="flexBox-vertical" style="margin:5px; overflow:scroll;">
    <Table kind="controls" style="height:50%;" cellStyle="vertical-align: top">
      <col index="0" kind="label"/>
      <col index="2" kind="label"/>

      <row>
        <Label for="Type" class="bee-required" />
        <DataSelector name="Type" source="Type" required="true" choiceColumns="Name"
                      renderColumns="TypeName" style="&inp;"/>
        <Label for="State" text="=status" class="bee-required" />
        <DataSelector name="State" source="State" required="true" choiceColumns="Name" style="&inp;"
                      caching="local"/>
      </row>
      <row>
        <text/>
        <CheckBox source="Urgent" summarize="true"/>
        <Label text="=companyDepartment" class="bee-required" />
        <TextLabel source="CreatorDepartmentName" class="bee-output" style="&inp;"/>
      </row>
      <row>
        <br/>
      </row>
      <row>
        <Label text="=svcDevice" />
        <FlowPanel>
          <DataSelector name="ServiceObject" source="ServiceObject"
                        choiceColumns="SerialNo CategoryName ManufacturerName Model CustomerName ContactPersonFirstName ContactPersonLastName ContactPersonPhone"
                        style="&inp;" />
          <FaLabel name="ServiceObjectAdd" char="plus_circle" style="&addStyle;" class="bee-MultiSelector-plus"/>
        </FlowPanel>
        <Label for="Contact" />
        <FlowPanel>
        <DataSelector name="Contact" source="Contact"
                      choiceColumns="FirstName LastName Phone Email Address CompanyName"
                      renderColumns="ContactFirstName ContactLastName" style="&inp;" options="Company"/>
          <FaLabel name="ContactAdd" char="plus_circle" style="&addStyle;" class="bee-MultiSelector-plus"/>
        </FlowPanel>
      </row>
      <row>
        <Label text="=category" class="bee-required" />
        <TextLabel source="CategoryName" class="bee-output" style="&inp;"/>
        <Label text="=phone" class="bee-required" />
        <DataSelector name="Phone" source="Contact" required="true"
                      choiceColumns="FirstName LastName Phone Email Address CompanyName" renderColumns="ContactPhone"
                      style="&inp;" options="Company" />
      </row>
      <row>
        <Label text="=tcdBrand" />
        <TextLabel source="ManufacturerName" class="bee-output" style="&inp;"/>
        <Label for="Company" text="=client" />
        <DataSelector name="Company" source="Company"
                      choiceColumns="Name TypeName" renderColumns="CompanyName CompanyTypeName"
                      style="&inp;"/>
      </row>
      <row>
        <Label for="Model" />
        <TextLabel source="Model" class="bee-output" style="&inp;"/>
        <Label text="=email" />
        <DataSelector name="Email" source="Contact" viewName="CompanyPersons"
                      choiceColumns="FirstName LastName Phone Email Address CompanyName"
                      renderColumns="ContactEmail" style="&inp;"
                      options="Company"/>
      </row>
      <row>
        <Label text="=svcSerialNo"/>
        <TextLabel source="SerialNo" class="bee-output" style="&inp;"/>
        <Label name="AddressLabel" text="=address" />
        <DataSelector name="Address" source="Contact"
                      choiceColumns="FirstName LastName Phone Email Address CompanyName"
                      renderColumns="ContactAddress" style="&inp;"
                      options="Company"/>
      </row>
      <row>
        <cell rowSpan="3">
          <Label for="Equipment"/>
        </cell>
        <cell rowSpan="3">
          <InputArea source="Equipment" visibleLines="5" style="&inp;"/>
        </cell>
        <text/>
        <CheckBox name="Warranty" text="=svcWarrantyMaintenance" summarize="true" />
      </row>
      <row>
        <Label name="WarrantyTypeName" for="WarrantyType" />
        <DataSelector source="WarrantyType" style="&inp;"/>
      </row>
      <row>
        <Label for="WarrantyMaintenance" />
        <DataSelector name="WarrantyMaintenance" source="WarrantyMaintenance" choiceColumns="Id"
                     filter="WarrantyValidTo > {t}" style="&inp;"/>
      </row>
      <row>
        <cell rowSpan="2">
          <Label for="Description"/>
        </cell>
        <cell rowSpan="2">
          <InputArea source="Description" visibleLines="4" style="&inp;"/>
        </cell>
        <Label for="Contractor" text="=svcContractor" />
        <TextLabel source="ContractorName" class="bee-output" style="&inp;"/>
      </row>
      <row>
        <Label for="Repairer" />
        <DataSelector source="Repairer" renderColumns="RepairerFirstName RepairerLastName"
                      style="&inp;"/>
      </row>
      <row>
        <br/>
      </row>
      <row>
        <Label for="Date" />
        <DateTimeLabel source="Date" class="bee-output" />
        <Label for="EndingDate" />
        <DateTimeLabel source="EndingDate" format="DATE_TIME_SHORT" class="bee-output"/>
      </row>
      <row>
        <Label for="Creator" />
        <TextLabel class="bee-output" style="&inp;">
          <renderToken source="CreatorFirstName"/>
          <renderToken source="CreatorLastName"/>
        </TextLabel>
        <Label for="WarrantyValidTo" />
        <InputDateTime source="WarrantyValidTo"  />
      </row>
    </Table>
    <TabbedPages name="ChildTabs" style="height: 800px;">
      <page>
        <text>=svcComments</text>
        <FlowPanel name="MaintenanceComments" class="flex-horizontal"/>
      </page>
      <page>
        <text>=svcMaintenanceItemsServices</text>
        <ChildGrid name="Maintenance" relColumn="ServiceMaintenance" />
      </page>
      <page>
        <text>=svcInvoices</text>
        <GridPanel name="ObjectInvoices" parent="{form}" child="true" />
      </page>
      <page>
        <text>=svcDefects</text>
        <ChildGrid name="ObjectDefects" relColumn="ServiceMaintenance" />
      </page>
      <page module="Tasks">
        <text>=crmTasks</text>
        <ChildGrid name="RelatedTasks" relColumn="ServiceMaintenance" />
      </page>
      <page>
        <text>=svcDates</text>
        <ChildGrid name="ServiceDates" relColumn="ServiceMaintenance" />
      </page>
    </TabbedPages>
  </FlowPanel>
</f:Form>
