<?xml version="1.0" encoding="UTF-8"?>
<View xmlns="http://www.butent.com/view"
  xmlns:x="http://www.butent.com/expression"

  name="ServiceTree"
  source="ServiceTree"
  >
  <Columns>
    <SimpleColumn name="Parent" />
    <SimpleColumn name="Order" />
    <SimpleColumn name="Name" />
    <SimpleJoin joinType="LEFT" name="Parent">
      <SimpleColumn alias="ParentOrder" name="Order" />
      <SimpleColumn alias="ParentName" name="Name" />
    </SimpleJoin>
    <ExternalJoin source="ServiceObjects" joinType="LEFT" name="Category">
      <AggregateColumn alias="ObjectCount" aggregate="COUNT" name="Category" />
      <HiddenColumn name="Status" alias="SvcObjects" />
      <AggregateColumn name="Status" alias="SvcObjectsCount" aggregate="COUNT">
          <x:switch  type="INTEGER">
             <x:number>"SvcObjects"</x:number>
             <x:case>
                <x:number>0</x:number>
                <x:then>
                  <x:number>1</x:number>
                </x:then>
             </x:case>
             <x:else>
              <x:number>null</x:number>
             </x:else>
          </x:switch>
        </AggregateColumn>
      <HiddenColumn name="Status" alias="ProjObjects" />
      <AggregateColumn name="Status" alias="ProjObjectsCount" aggregate="COUNT">
          <x:switch  type="INTEGER">
             <x:number>"ProjObjects"</x:number>
             <x:case>
                <x:number>1</x:number>
                <x:then>
                  <x:number>1</x:number>
                </x:then>
             </x:case>
             <x:else>
              <x:number>null</x:number>
             </x:else>
          </x:switch>
      </AggregateColumn>

      <HiddenColumn name="Status" alias="PotObjects" />
      <AggregateColumn name="Status" alias="PotObjectsCount" aggregate="COUNT">
          <x:switch  type="INTEGER">
             <x:number>"PotObjects"</x:number>
             <x:case>
                <x:number>2</x:number>
                <x:then>
                  <x:number>1</x:number>
                </x:then>
             </x:case>
             <x:else>
              <x:number>null</x:number>
             </x:else>
          </x:switch>
      </AggregateColumn>

      <HiddenColumn name="Status" alias="LostObjects" />
      <AggregateColumn name="Status" alias="LostObjectsCount" aggregate="COUNT">
        <x:switch  type="INTEGER">
          <x:number>"LostObjects"</x:number>
          <x:case>
            <x:number>3</x:number>
            <x:then>
              <x:number>1</x:number>
            </x:then>
          </x:case>
          <x:else>
            <x:number>null</x:number>
          </x:else>
        </x:switch>
      </AggregateColumn>
      
      <HiddenColumn name="Status" alias="TemplateObjects" />
      <AggregateColumn name="Status" alias="TemplateObjectsCount" aggregate="COUNT">
        <x:switch  type="INTEGER">
          <x:number>"TemplateObjects"</x:number>
          <x:case>
            <x:number>4</x:number>
            <x:then>
              <x:number>1</x:number>
            </x:then>
          </x:case>
          <x:else>
            <x:number>null</x:number>
          </x:else>
        </x:switch>
      </AggregateColumn>
    </ExternalJoin>
  </Columns>
  <Order>
    <OrderBy column="ParentOrder" />
    <OrderBy column="Order" />
  </Order>
</View>
